# Proxmox Cluster Assessment Scope Template

metadata:
  engagement_name: "Proxmox Cluster Security Assessment"
  engagement_type: "internal"
  tester: "your-name"

settings:
  operational_mode: "recon-only"  # Start with recon
  require_validation: true

networks:
  - name: "Proxmox Management"
    type: "internal"
    vlan: 101
    cidr: "10.0.101.0/24"
    gateway: "10.0.101.1"
    description: "Proxmox cluster management network"

  - name: "VM Network"
    type: "internal"
    vlan: 102
    cidr: "10.0.102.0/24"
    description: "Virtual machine network"

  - name: "Storage Network"
    type: "internal"
    vlan: 103
    cidr: "10.0.103.0/24"
    description: "Ceph/storage cluster network"

targets:
  # Proxmox nodes
  - host: "10.0.101.2"
    name: "pve-node-01"
    type: "infrastructure"
    network: "Proxmox Management"
    ports: [22, 8006, 3128, 5900]  # VNC starts at 5900
    services:
      - port: 8006
        service: "proxmox-ve"
        version: "8.x"
      - port: 3128
        service: "spiceproxy"
    credentials:
      - username: "root@pam"
        password_env: "PVE_ROOT_PASS"
        access_level: "admin"
    tags: ["hypervisor", "cluster-master", "critical"]
    modules: ["proxmox_ve"]

  - host: "10.0.101.3"
    name: "pve-node-02"
    type: "infrastructure"
    network: "Proxmox Management"
    ports: [22, 8006, 3128]
    tags: ["hypervisor", "cluster-member"]
    modules: ["proxmox_ve"]

  - host: "10.0.101.4"
    name: "pve-node-03"
    type: "infrastructure"
    network: "Proxmox Management"
    ports: [22, 8006, 3128]
    tags: ["hypervisor", "cluster-member"]
    modules: ["proxmox_ve"]

  # PBS (Proxmox Backup Server) if present
  - host: "10.0.101.10"
    name: "pbs-backup-01"
    type: "infrastructure"
    network: "Proxmox Management"
    ports: [22, 8007]
    services:
      - port: 8007
        service: "proxmox-backup"
    tags: ["backup", "critical"]
    modules: ["proxmox_ve"]

exclusions:
  hosts:
    - "10.0.101.1"      # Gateway
    - "10.0.101.254"    # Monitoring/IPMI
  cidrs:
    - "10.0.103.0/24"   # Storage network - don't scan (performance impact)
  ports:
    - 111     # rpcbind
    - 2049    # NFS
    - 6789    # Ceph monitor
    - 6800    # Ceph OSD range start (6800-7300)

# Focus areas for Proxmox testing
test_focus:
  - "API authentication bypass"
  - "Privilege escalation (user to admin)"
  - "VM escape vectors"
  - "Container (LXC) escape"
  - "Cluster authentication (corosync)"
  - "Default credentials"
  - "Known CVEs (CVE-2022-35508, etc.)"
  - "Backup access controls"
  - "Storage permission misconfigurations"
